<!DOCTYPE html>
<html lang="nl">
<head>
  <script>
    // Sterke cache-buster: plak ?v=<timestamp> aan CSS/JS zodat je altijd de nieuwste versie krijgt
    (function(){
      try{
        var v = Date.now();
        document.addEventListener('DOMContentLoaded', function(){
          document.querySelectorAll('link[rel="stylesheet"][href]').forEach(function(link){
            var href = link.getAttribute('href');
            if (href && href.indexOf('?') === -1) { link.href = href + '?v=' + v; }
          });
          document.querySelectorAll('script[src]').forEach(function(s){
            var src = s.getAttribute('src');
            if (src && src.indexOf('?') === -1) { s.src = src + '?v=' + v; }
          });
        });
      }catch{}
    })();
  </script>
  <meta charset="utf-8">
  <meta http-equiv="cache-control" content="no-cache, no-store, must-revalidate">
  <meta http-equiv="pragma" content="no-cache">
  <meta http-equiv="expires" content="0">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Script Runner</title>
  <link rel="stylesheet" href="css/style.css?v=20251104-1">
  <script src="js/status-indicators.js"></script>
  <script>
    // Centraliseer backend helpers via StatusIndicators (indien beschikbaar)
    window.getBackendBase = function(){ try{ return (window.StatusIndicators && StatusIndicators.getBase()) || (localStorage.getItem('backendBase')||'http://localhost:3002'); }catch{ return 'http://localhost:3002'; } }
    window.detectBackendBaseOnce = function(){ return (window.StatusIndicators && StatusIndicators.detectBaseOnce()) || Promise.resolve(window.getBackendBase()); }
  </script>
  <script>
    function normBase(u){ try { return String(u||'').trim().replace(/\/$/,''); } catch { return 'http://localhost:3002'; } }
    // getBackendBase is geshimd hierboven
    function setBackendBase(u, persist){
      const v = normBase(u||'');
      try { sessionStorage.setItem('backendBase', v); } catch{}
      if (persist) { try { localStorage.setItem('backendBase', v); } catch{} }
      const pill = document.getElementById('base-pill'); if (pill) pill.textContent = 'base: ' + v;
      const inp = document.getElementById('base-input'); if (inp && !inp.value) inp.value = v;
      try { updateBackendLamp(); } catch{}
      return v;
    }
    async function updateBackendLamp(){
      const base = 'https://mister-portfolio-backend.onrender.com';
      const chip = document.getElementById('backend-chip');
      if (!chip) return;
      const label = chip.querySelector('.label');
      chip.classList.remove('ok','warn','err','muted'); chip.classList.add('muted');
      if (label) label.textContent = 'backend: checken‚Ä¶';
      const t0 = (typeof performance !== 'undefined' && performance.now) ? performance.now() : Date.now();
      try{
        const r = await fetch(base + '/health', { cache:'no-store' });
        if (r.ok){
          const ms = Math.max(0, Math.round(((typeof performance !== 'undefined' && performance.now)?performance.now():Date.now()) - t0));
          chip.classList.remove('muted','warn','err'); chip.classList.add('ok');
          if (label) label.textContent = 'backend: online' + (ms? ` (${ms}ms)` : '');
          return true;
        }
        chip.classList.remove('muted','ok','warn'); chip.classList.add('err');
        if (label) label.textContent = 'backend: offline (HTTP '+r.status+')';
        return false;
      }catch(e){
        chip.classList.remove('muted','ok','warn'); chip.classList.add('err');
        if (label) label.textContent = 'backend: offline';
        return false;
      }
    }
    function updateLiveServerLamp(){
      const chip = document.getElementById('live-chip');
      if (!chip) return;
      const label = chip.querySelector('.label');
      const is8000 = /^(http:\/\/)?(localhost|127\.0\.0\.1)(:8000)/.test(location.href) || location.port === '8000';
      <!DOCTYPE html>
      <html lang="nl">
      <head>
        <script>
          // Sterke cache-buster: plak ?v=<timestamp> aan CSS/JS zodat je altijd de nieuwste versie krijgt
          (function(){
            try{
              var v = Date.now();
              document.addEventListener('DOMContentLoaded', function(){
                document.querySelectorAll('link[rel="stylesheet"][href]').forEach(function(link){
                  var href = link.getAttribute('href');
                  if (href && href.indexOf('?') === -1) { link.href = href + '?v=' + v; }
                });
                document.querySelectorAll('script[src]').forEach(function(s){
                  var src = s.getAttribute('src');
                  if (src && src.indexOf('?') === -1) { s.src = src + '?v=' + v; }
                });
              });
            }catch{}
          })();
        </script>
        <meta charset="utf-8">
        <meta http-equiv="cache-control" content="no-cache, no-store, must-revalidate">
        <meta http-equiv="pragma" content="no-cache">
        <meta http-equiv="expires" content="0">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>Script Runner</title>
        <link rel="stylesheet" href="css/style.css?v=20251104-1">
        <script src="js/status-indicators.js"></script>
        <style>
          /* Match admin panel palette */
          body { background:#181828; color:#e3e6f0; font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji"; }
          .wrap { max-width: 960px; margin: 0 auto; padding: 24px 12px; }
        h1 { font-size: 1.6rem; margin: 8px 0 18px; color: #f3f4fa; }
        /* Kaart-variabelen zijn gecentraliseerd in css/style.css */
          .muted { color:#9ca3af; font-size: 0.95rem; }
          .grid { display:grid; grid-template-columns: repeat(2, minmax(0,1fr)); gap: 12px; }
          @media (max-width: 820px) { .grid { grid-template-columns: 1fr; } }
        .card { background:#23234a; border: var(--card-border-w) solid var(--card-border-color); border-radius: var(--card-radius); padding: 18px; display:flex; flex-direction:column; gap: 10px; box-shadow: var(--card-shadow); }
          .card h3 { margin:0; font-size: 1rem; color:#f3f4fa; }
          .card p { margin:0; font-size: .95rem; color:#e5e7eb; }
        .row { display:flex; gap: 8px; align-items:center; flex-wrap:wrap; }
        .row-justify { justify-content: space-between; }
        .controls { display:flex; gap:8px; align-items:center; flex-wrap:wrap; margin: 6px 0 14px; }
        .input { background:#181828; border:1px solid #333; color:#e3e6f0; border-radius:8px; padding:8px 10px; }
          .btn { background:#0f0f1a; border:1px solid #7c3aed; color:#e5e7eb; font-weight:700; border-radius: 8px; padding: 8px 12px; cursor:pointer; }
          .btn:hover { background:#171128; border-color:#8b5cf6; }
          .pill { border:1px solid #2a2a5a; border-radius:8px; padding:6px 10px; color:#9ca3af; font-size:12px; background:#0f0f1a; }
        /* status chips */
          .chip { border:1px solid #2a2a5a; border-radius:8px; padding:6px 10px; font-size:12px; color:#9ca3af; display:inline-flex; align-items:center; gap:6px; background:#0f0f1a; }
        .chip .dot { width:8px; height:8px; border-radius:999px; background:#6b7280; display:inline-block; }
        .chip.ok { color:#bbf7d0; border-color:#1f8a4b; }
        .chip.ok .dot { background:#22c55e; box-shadow:0 0 0 3px rgba(34,197,94,.15); }
        .chip.warn { color:#fde68a; border-color:#9a6b1f; }
        .chip.warn .dot { background:#f59e0b; box-shadow:0 0 0 3px rgba(245,158,11,.15); }
        .chip.err { color:#fecaca; border-color:#8a1f1f; }
        .chip.err .dot { background:#ef4444; box-shadow:0 0 0 3px rgba(239,68,68,.15); }
        .chip.muted { color:#9ca3af; }
        .chip + .chip { margin-left:6px; }
          pre { background:#0b0b0b; border:1px solid #23234a; border-radius:8px; color:#d1d5db; padding:10px; overflow:auto; font-size:12px; }
          .out { margin-top:6px; }
          .flex1 { flex:1; }
          .hidden { display:none; }
          .max260 { max-width:260px; }
          .banner { background:#181828; border:1px solid #333; color:#e3e6f0; border-radius:10px; padding:10px 12px; margin:10px 0; }
          .banner strong{ color:#f59e0b; }
        /* Header nav buttons */
        .nav-btn{ background:#111827; border:1px solid #374151; color:#e5e7eb; border-radius:999px; padding:6px 12px; cursor:pointer; font-weight:600; text-decoration:none; }
        .nav-btn:hover{ border-color:#6b7280; }
        </style>
        <script>
          // Centraliseer backend helpers via StatusIndicators (indien beschikbaar)
          window.getBackendBase = function(){ try{ return (window.StatusIndicators && StatusIndicators.getBase()) || (localStorage.getItem('backendBase')||'https://mister-portfolio-backend.onrender.com'); }catch{ return 'https://mister-portfolio-backend.onrender.com'; } }
          window.detectBackendBaseOnce = function(){ return (window.StatusIndicators && StatusIndicators.detectBaseOnce()) || Promise.resolve(window.getBackendBase()); }
        </script>
        <script>
          function normBase(u){ try { return String(u||'').trim().replace(/\/$/,''); } catch { return 'http://localhost:3002'; } }
          // getBackendBase is geshimd hierboven
          function setBackendBase(u, persist){
            const v = normBase(u||'');
            try { sessionStorage.setItem('backendBase', v); } catch{}
            if (persist) { try { localStorage.setItem('backendBase', v); } catch{} }
            const pill = document.getElementById('base-pill'); if (pill) pill.textContent = 'base: ' + v;
            const inp = document.getElementById('base-input'); if (inp && !inp.value) inp.value = v;
            try { updateBackendLamp(); } catch{}
            return v;
          }
          async function updateBackendLamp(){
            const base = getBackendBase();
            const chip = document.getElementById('backend-chip');
            if (!chip) return;
            const label = chip.querySelector('.label');
            chip.classList.remove('ok','warn','err','muted'); chip.classList.add('muted');
            if (label) label.textContent = 'backend: checken‚Ä¶';
            const t0 = (typeof performance !== 'undefined' && performance.now) ? performance.now() : Date.now();
            try{
              const r = await fetch(base + '/health', { cache:'no-store' });
              if (r.ok){
                const ms = Math.max(0, Math.round(((typeof performance !== 'undefined' && performance.now)?performance.now():Date.now()) - t0));
                chip.classList.remove('muted','warn','err'); chip.classList.add('ok');
                if (label) label.textContent = 'backend: online' + (ms? ` (${ms}ms)` : '');
                return true;
              }
              chip.classList.remove('muted','ok','warn'); chip.classList.add('err');
              if (label) label.textContent = 'backend: offline (HTTP '+r.status+')';
              return false;
            }catch(e){
              chip.classList.remove('muted','ok','warn'); chip.classList.add('err');
              if (label) label.textContent = 'backend: offline';
              return false;
            }
          }
          function updateLiveServerLamp(){
            const chip = document.getElementById('live-chip');
            if (!chip) return;
            const label = chip.querySelector('.label');
            const is8000 = /^(http:\/\/)?(localhost|127\.0\.0\.1)(:8000)/.test(location.href) || location.port === '8000';
            chip.classList.remove('ok','warn','err','muted');
            if (is8000){ chip.classList.add('ok'); if (label) label.textContent = 'live: 8000'; }
            else { chip.classList.add('warn'); if (label) label.textContent = 'live: niet 8000'; }
          }
          // detectBackendBaseOnce is geshimd hierboven
          function saveBackendBaseUrl(){
            try { const inp = document.getElementById('base-input'); if (!inp) return; setBackendBase(inp.value, true); } catch{}
          }
          async function autoDetectBackendBase(){
            try { await detectBackendBaseOnce(); } catch{}
          }
          function renderCards(intoEl, items){
            intoEl.innerHTML = '';
            items.forEach(s => {
              const card = document.createElement('div');
              card.className = 'card';
              card.innerHTML = `
                <div class="row">
                  <h3 class="flex1">${s.title||s.id}</h3>
                  <span class="pill">${s.background? 'background' : 'foreground'}</span>
                </div>
                <p>${s.desc||''}</p>
                <div class="row">
                  <button class="btn" data-id="${s.id}">Run</button>
                  <span class="pill" id="status-${s.id}">wachten‚Ä¶</span>
                </div>
                <div class="out hidden" id="out-${s.id}"></div>
              `;
              intoEl.appendChild(card);
            });
            intoEl.querySelectorAll('button.btn').forEach(btn => {
              btn.addEventListener('click', async () => { runScript(btn.getAttribute('data-id')); });
            });
          }

          async function loadScripts(){
            const base = await detectBackendBaseOnce();
            try { updateBackendLamp(); } catch{}
            try { updateLiveServerLamp(); } catch{}
            // LIVE omgeving: toon alternatieve tools en schakel lokale scripts uit
            try{
              if (window.StatusIndicators && StatusIndicators.getEnvMode && StatusIndicators.getEnvMode()==='live'){
                const wrap = document.querySelector('.wrap');
                // Info banner
                const b = document.getElementById('offline');
                if (b){
                  b.classList.remove('hidden');
                  const msg=b.querySelector('.msg');
                  if (msg) msg.textContent = 'LIVE omgeving: lokale scripts uitgeschakeld. Gebruik Live Tools.';
                  const btnRow = b.querySelector('div.row:nth-child(2)');
                  if (btnRow && !document.getElementById('open-live-tools-btn')){
                    const a = document.createElement('a');
                    a.id = 'open-live-tools-btn';
                    a.className = 'nav-btn';
                    a.href = 'live-tools.html';
                    a.textContent = 'Open Live Tools';
                    btnRow.appendChild(a);
                  }
                }
                // Render live tools sectie eenmaal
                if (!document.getElementById('live-tools')){
                  const live = document.createElement('div');
                  live.id = 'live-tools';
                  live.className = 'card';
                  live.innerHTML = `
                    <h3>Live tools</h3>
                    <p class="muted">Handige snelkoppelingen voor de live omgeving. Lokale scripts en workflow draaien hier niet.</p>
                    <div class="row" style="flex-wrap:wrap;gap:8px;margin-top:8px;">
                      <a class="nav-btn" href="https://github.com/chinfosieeuw9-prog/mister-portfolio" target="_blank" rel="noopener">üîó GitHub repo</a>
                      <a class="nav-btn" href="https://supabase.com/dashboard/project/tesqycomyyifqcwdpetp/settings/general" target="_blank" rel="noopener">üóÑÔ∏è Supabase</a>
                      <a class="nav-btn" href="https://formspree.io/forms/xgvpzgaz/integration" target="_blank" rel="noopener">üì® Formspree</a>
                      <a class="nav-btn" href="https://github.com/chinfosieeuw9-prog/mister-portfolio/actions" target="_blank" rel="noopener">‚öôÔ∏è Actions</a>
                      <a class="nav-btn" href="https://github.com/chinfosieeuw9-prog/mister-portfolio/actions/workflows/ci.yml" target="_blank" rel="noopener" title="Run CI (indien workflow_dispatch)">‚ñ∂ CI</a>
                      <a class="nav-btn" href="https://github.com/chinfosieeuw9-prog/mister-portfolio/actions?query=workflow%3A%22pages+build+and+deployment%22" target="_blank" rel="noopener" title="Open Pages build & deployment">‚ñ∂ Pages build</a>
                      <a class="nav-btn" href="https://github.com/chinfosieeuw9-prog/mister-portfolio/settings" target="_blank" rel="noopener">üîß Repo settings</a>
                      <a class="nav-btn" href="https://vercel.com/james-projects-9dae239b" target="_blank" rel="noopener">‚ñ≤ Vercel</a>
                      <a class="nav-btn" href="https://vercel.com/james-projects-9dae239b/mister-portfolio/deployments" target="_blank" rel="noopener">‚ñ≤ Deployments</a>
                      <a class="nav-btn" href="https://vercel.com/james-projects-9dae239b/mister-portfolio/5cs4zzwkEM9tk4veaLrvkeQbF1K3" target="_blank" rel="noopener">üîç Deployment details</a>
                      <a class="nav-btn" href="https://dashboard.hcaptcha.com/overview" target="_blank" rel="noopener">üõ°Ô∏è hCaptcha</a>
                      <a class="nav-btn" href="https://dashboard.render.com/" target="_blank" rel="noopener">‚öôÔ∏è Render</a>
                      <a class="nav-btn" href="https://dash.cloudflare.com/" target="_blank" rel="noopener" title="Open Cloudflare dashboard; kies daarna je account en zone">‚òÅÔ∏è Cloudflare dashboard</a>
                      <a class="nav-btn" href="/logs.html" target="_self">üìä Logboek</a>
                      <a class="nav-btn" href="live-tools.html" target="_self">üß≠ Open Live Tools pagina</a>
                    </div>`;
                  const controls = document.querySelector('.controls');
                  if (controls) controls.insertAdjacentElement('afterend', live); else wrap.appendChild(live);
                }
                // Verberg lijst van scripts
                const favEl = document.getElementById('fav'); if (favEl) favEl.innerHTML = '<div class="muted">Live modus: geen lokale scripts.</div>';
                const listEl = document.getElementById('list'); if (listEl) listEl.innerHTML = '';
                return; // stop hier in live modus
              }
            }catch{}
            const favEl = document.getElementById('fav');
            const listEl = document.getElementById('list');
            listEl.innerHTML = '<div class="muted">Laden‚Ä¶</div>';
            try{
              const r = await fetch(base + '/scripts/list', { cache:'no-store' });
              const j = await r.json();
        const arr = (j && j.scripts) || [];
              if (!arr.length){ listEl.innerHTML = '<div class="muted">Geen scripts gevonden.</div>'; return; }
          // Favorites (incl. log-prune tools)
        const favIds = ['open-scripts','start-backend-3002-safe','start-live-server-safe','open-admin','restart-backend-hard','detect-base-and-health','prune-logs-keep10','prune-logs-keep15'];
              const fav = arr.filter(x => favIds.includes(x.id));
              renderCards(favEl, fav);
              renderCards(listEl, arr);
              // hide banner if visible
              try{ document.getElementById('offline')?.classList.add('hidden'); }catch{}
            } catch(e){
              listEl.innerHTML = '<div class="muted">Fout bij laden: '+(e.message||e)+'</div>';
              const b = document.getElementById('offline');
              if (b){
                b.querySelector('.msg').textContent = 'Backend offline of geblokkeerd. Probeer 3002 of auto-detect.';
                b.classList.remove('hidden');
              }
            }
          }
          async function runScript(id){
            const base = getBackendBase();
            const statusEl = document.getElementById('status-'+id);
            const outEl = document.getElementById('out-'+id);
            statusEl.textContent = 'bezig‚Ä¶'; statusEl.style.color = '#9ca3af';
            outEl.style.display='none'; outEl.classList.remove('hidden'); outEl.innerHTML='';
            try{
              const r = await fetch(base + '/scripts/run', {
                method: 'POST', headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ id })
              });
              const j = await r.json().catch(()=>({}));
              if (!r.ok){ throw new Error(j && j.error ? j.error : ('HTTP '+r.status)); }
              if (j.started){
                statusEl.textContent = j.pid ? `gestart (pid ${j.pid})` : 'gestart (background)';
                statusEl.style.color = '#22c55e';
              } else {
                statusEl.textContent = 'klaar'; statusEl.style.color = '#22c55e';
                const pre = document.createElement('pre');
                pre.textContent = (j.stdout||'') + (j.stderr? ('\n-- STDERR --\n'+j.stderr) : '');
                outEl.innerHTML = ''; outEl.appendChild(pre);
                // Add a small link to view backup logs when workflow finished
                if (id === 'workflow-run'){
                  const a = document.createElement('a');
                  a.href = 'logs.html?v=' + Date.now();
                  a.textContent = 'üìä View backup';
                  a.className = 'nav-btn';
                  a.style.marginTop = '8px';
                  a.style.display = 'inline-block';
                  outEl.appendChild(a);
                }
                outEl.style.display='block';
              }
            } catch(e){
              // Retry with GET fallback (no preflight)
              try{
                const r2 = await fetch(base + '/scripts/run?id=' + encodeURIComponent(id), { cache:'no-store' });
                const j2 = await r2.json().catch(()=>({}));
                if (!r2.ok){ throw new Error(j2 && j2.error ? j2.error : ('HTTP '+r2.status)); }
                if (j2.started){
                  statusEl.textContent = j2.pid ? `gestart (pid ${j2.pid})` : 'gestart (background)';
                  statusEl.style.color = '#22c55e';
                } else {
                  statusEl.textContent = 'klaar'; statusEl.style.color = '#22c55e';
                  const pre = document.createElement('pre');
                  pre.textContent = (j2.stdout||'') + (j2.stderr? ('\n-- STDERR --\n'+j2.stderr) : '');
                  outEl.innerHTML = ''; outEl.appendChild(pre);
                  if (id === 'workflow-run'){
                    const a = document.createElement('a');
                    a.href = 'logs.html?v=' + Date.now();
                    a.textContent = 'üìä View backup';
                    a.className = 'nav-btn';
                    a.style.marginTop = '8px';
                    a.style.display = 'inline-block';
                    outEl.appendChild(a);
                  }
                  outEl.style.display='block';
                }
                return;
              } catch(err2){
                statusEl.textContent = 'fout'; statusEl.style.color = '#ef4444';
                outEl.classList.remove('hidden'); outEl.style.display='block';
                outEl.innerHTML = '<pre>'+String((err2 && err2.message) || (e && e.message) || e)+'</pre>';
                const b = document.getElementById('offline');
                if (b){ b.querySelector('.msg').textContent = 'Kan script niet starten. Controleer of backend draait op 3002 en probeer Auto-detect.'; b.classList.remove('hidden'); }
              }
            }
          }
          document.addEventListener('DOMContentLoaded', () => {
            // Apply saved design preset
            try{
              const preset = localStorage.getItem('scriptsCardPreset') || 'normaal';
              applyCardPreset(preset);
            }catch{}
            loadScripts();
            // Toon melding wanneer in 'live' omgeving (scripts zijn lokaal bedoeld)
            try{
              if (window.StatusIndicators && StatusIndicators.getEnvMode && StatusIndicators.getEnvMode()==='live'){
                const offline = document.getElementById('offline');
                if (offline){
                  offline.classList.remove('hidden');
                  const msg = offline.querySelector('.msg');
                  if (msg) msg.textContent = 'Omgeving staat op LIVE. Script runner is alleen voor lokaal gebruik.';
                }
              }
            }catch{}
            // periodiek ping voor indicatoren
            setInterval(() => { try{ updateBackendLamp(); }catch{} }, 7000);
            setInterval(() => { try{ updateLiveServerLamp(); }catch{} }, 12000);
          });

          // Design presets for quick preview (border width + radius)
          function applyCardPreset(preset){
            try{
              const root = document.documentElement;
              if (preset==='dun'){
                root.style.setProperty('--card-border-w','1px');
                root.style.setProperty('--card-radius','10px');
                root.style.setProperty('--card-border-color','#2a2a5a');
                root.style.setProperty('--card-shadow','0 2px 10px #0002');
              }
              else if (preset==='dik'){
                root.style.setProperty('--card-border-w','3px');
                root.style.setProperty('--card-radius','16px');
                root.style.setProperty('--card-border-color','#7c3aed'); /* violet */
                root.style.setProperty('--card-shadow','0 4px 16px #0002');
              }
              else if (preset==='extra'){
                root.style.setProperty('--card-border-w','4px');
                root.style.setProperty('--card-radius','18px');
                root.style.setProperty('--card-border-color','#8b5cf6'); /* violet lighter */
                root.style.setProperty('--card-shadow','0 4px 18px rgba(139,92,246,.15)');
              }
              else {
                root.style.setProperty('--card-border-w','1.5px');
                root.style.setProperty('--card-radius','14px');
                root.style.setProperty('--card-border-color','#333');
                root.style.setProperty('--card-shadow','0 4px 16px #0002');
                preset='normaal';
              }
              try { localStorage.setItem('scriptsCardPreset', preset); } catch{}
              // Toggle active state
              document.querySelectorAll('.design-btn').forEach(b=>b.classList.remove('active'));
              const btn = document.querySelector(`[data-preset="${preset}"]`); if (btn) btn.classList.add('active');
            }catch{}
          }
        </script>
      </head>
      <body>
        <div class="wrap">
          <div class="row row-justify">
            <h1>Script Runner</h1>
            <div class="row" style="gap:6px; align-items:center;">
              <a class="nav-btn" href="index.html" title="Terug naar Home">‚Üê Home</a>
              <a class="nav-btn" href="admin.html" title="Open Admin">‚öôÔ∏è Admin</a>
              <button class="nav-btn" onclick="location.href=location.pathname+'?v='+Date.now()" title="Harde refresh">‚Üª Refresh</button>
              <span id="backend-chip" class="chip muted" title="Status van de backend (health)"><span class="dot"></span><span class="label">backend: ‚Äî</span></span>
              <span id="live-chip" class="chip muted" title="Status van de live server (8000)"><span class="dot"></span><span class="label">live: ‚Äî</span></span>
              <span id="base-pill" class="pill">base: ‚Äî</span>
            </div>
          </div>
          <!-- Quick design toggles -->
          <div class="row" style="gap:8px;margin:6px 0 4px;align-items:center;flex-wrap:wrap;">
            <span class="muted" style="font-size:12px;">Stijl:</span>
            <button class="nav-btn design-btn" data-preset="dun" onclick="applyCardPreset('dun')">Rand: dun</button>
            <button class="nav-btn design-btn" data-preset="normaal" onclick="applyCardPreset('normaal')">Rand: normaal</button>
            <button class="nav-btn design-btn" data-preset="dik" onclick="applyCardPreset('dik')">Rand: dik</button>
            <button class="nav-btn design-btn" data-preset="extra" onclick="applyCardPreset('extra')">Rand: extra dik</button>
          </div>
          <div id="offline" class="banner hidden">
            <div class="row" style="justify-content:space-between;gap:8px;align-items:center;flex-wrap:wrap;">
              <div class="msg">Backend offline of niet gevonden.</div>
              <div class="row" style="gap:6px;">
                <button class="btn" onclick="setBackendBase('http://localhost:3002', true); loadScripts();">Probeer 3002</button>
                <button class="btn" onclick="autoDetectBackendBase().then(loadScripts)">Auto-detect</button>
                <button class="btn" onclick="location.href='http://localhost:8000/scripts.html'">Open via Live Server</button>
              </div>
            </div>
          </div>
          <p class="muted">Start je meest gebruikte scripts met √©√©n klik. Achtergrond-scripts blijven draaien; foreground-scripts tonen hieronder de uitvoer.</p>
          <div class="controls">
            <input id="base-input" type="url" class="input max260" placeholder="http://localhost:3002">
            <button class="btn" onclick="saveBackendBaseUrl()">üíæ Opslaan</button>
            <button class="btn" onclick="autoDetectBackendBase()">üîç Auto-detect</button>
          </div>
          <h2 style="font-size:1.1rem;color:#cbd5e1;margin:8px 0 10px;">Snelle acties</h2>
          <div id="fav" class="grid" style="margin-bottom:10px;"></div>
          <div id="list" class="grid"></div>

        <!-- Footer -->
        <div class="footer">
          <div class="footer-col">
            <div class="footer-powered">
              <span class="footer-powered-label">Powered by</span>
              <img class="footer-powered-img" src="https://cdn.jsdelivr.net/gh/simple-icons/simple-icons/icons/openai.svg" alt="OpenAI" title="OpenAI">
              <img class="footer-powered-img" src="https://cdn.jsdelivr.net/gh/simple-icons/simple-icons/icons/googlecloud.svg" alt="Google Cloud" title="Google Cloud">
              <img class="footer-powered-img" src="https://cdn.jsdelivr.net/gh/simple-icons/simple-icons/icons/vercel.svg" alt="Vercel" title="Vercel">
              <img class="footer-powered-img" src="https://cdn.jsdelivr.net/gh/simple-icons/simple-icons/icons/supabase.svg" alt="Supabase" title="Supabase">
            </div>
            <div class="footer-uptime-row">
              <a id="footer-uptime" href="https://uptimerobot.com/" target="_blank" rel="noopener noreferrer" title="UptimeRobot status">
                <img class="footer-uptime-img" src="https://img.shields.io/badge/UptimeRobot-configure--badge-555" alt="Uptime badge">
              </a>
            </div>
            <div class="footer-admin-row">
              <a href="admin.html" class="social-link admin-login-btn" id="admin-login-btn">
                <span>üîê</span><small id="site-version" class="admin-ver footer-version-badge">v7.9</small>
              </a>
            </div>
            <p class="footer-text footer-made">
              Made with ‚ù§Ô∏è by mister@2025 ‚Ä¢ Version <span id="site-version-footer">v7.9</span>
            </p>
          </div>
        </div>
      <script>
      // Versie auto-update uit logs/artifacts (zoals op index.html)
      (async function refreshVersionFromLogs(){
        try {
          let ver = null;
          // Try logs.json first
          try {
            const r = await fetch('logs/logs.json?ts='+Date.now());
            if (r.ok) {
              const j = await r.json();
              const arr = Array.isArray(j.entries) ? j.entries : [];
              for (let i = arr.length - 1; i >= 0; i--) {
                const e = arr[i];
                if (e && (e.type === 'workflow' || e.type === 'backup') && e.versionTag){ ver = e.versionTag; break; }
              }
            }
          } catch(e){ console.warn('read logs.json failed', e); }
          // Fallback to artifacts/last-backup.json
          if (!ver) {
            try {
              const r2 = await fetch('artifacts/last-backup.json?ts='+Date.now());
              if (r2.ok){ const j2 = await r2.json(); if (j2 && j2.versionTag) ver = j2.versionTag; }
            } catch(e){ console.warn('read last-backup.json failed', e); }
          }
          if (ver){
            const badge = document.getElementById('site-version');
            const foot = document.getElementById('site-version-footer');
            if (badge) badge.textContent = ver;
            if (foot) foot.textContent = ver;
          }
          return !!ver;
        } catch(e){ console.warn('refreshVersionFromLogs error', e); return false; }
      })();
      </script>
          </div>
        </div>
      </body>
      </html>
